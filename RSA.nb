(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     13250,        331]
NotebookOptionsPosition[     10991,        292]
NotebookOutlinePosition[     11412,        308]
CellTagsIndexPosition[     11369,        305]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"Clear", "[", "GenerateKeysRSA", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GenerateKeysRSA", "[", 
    RowBox[{"m_", "?", "NumericQ"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "e", ",", "d", ",", "p", ",", "q", ",", "\[Phi]"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"p", "=", 
       RowBox[{"RandomPrime", "[", 
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox["10", 
           RowBox[{"m", "-", "2"}]], ",", 
          SuperscriptBox["10", 
           RowBox[{"m", "-", "1"}]]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q", "=", 
       RowBox[{"RandomPrime", "[", "1000", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"p", " ", "q"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"IntegerLength", "[", "n", "]"}], "!=", "m"}], ",", 
        RowBox[{
         RowBox[{"q", "=", 
          RowBox[{"RandomPrime", "[", "100", "]"}]}], ";", 
         RowBox[{"n", "=", 
          RowBox[{"p", " ", "q"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Phi]", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"p", "-", "1"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"q", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"e", "=", 
       RowBox[{"RandomPrime", "[", 
        RowBox[{"{", 
         RowBox[{"3", ",", 
          RowBox[{"\[Phi]", "-", "1"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"PowerMod", "[", 
        RowBox[{"e", ",", 
         RowBox[{"-", "1"}], ",", "\[Phi]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"n", ",", "e"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "d"}], "}"}]}], "}"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EncodeRSA", "[", 
    RowBox[{
     RowBox[{"str_", "?", "StringQ"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n_", "?", "NumberQ"}], ",", 
       RowBox[{"e_", "?", "NumberQ"}]}], "}"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"StringJoin", "@", 
    RowBox[{"StringPadLeft", "[", 
     RowBox[{
      RowBox[{"ToString", "/@", 
       RowBox[{"PowerMod", "[", 
        RowBox[{
         RowBox[{"ToCharacterCode", "@", "str"}], ",", "e", ",", "n"}], 
        "]"}]}], ",", 
      RowBox[{"IntegerLength", "@", "n"}], ",", "\"\<0\>\""}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9529701716479244`*^9, 3.9529702271670685`*^9}, {
   3.9529707493600063`*^9, 3.9529708709888763`*^9}, 3.952971016984745*^9, {
   3.9529710650560837`*^9, 3.9529710793312054`*^9}, {3.952971109417223*^9, 
   3.9529711301368885`*^9}, {3.952971233149214*^9, 3.952971242966936*^9}, {
   3.9529713143084145`*^9, 3.952971416319376*^9}, {3.952971513165146*^9, 
   3.952971517883299*^9}, {3.9529715857299976`*^9, 3.952971619064142*^9}, {
   3.952971691072851*^9, 3.952971714260601*^9}, 3.9529718000209103`*^9, {
   3.952971861096657*^9, 3.95297186219866*^9}, {3.9529719024064407`*^9, 
   3.952971928034422*^9}, {3.9529719618955555`*^9, 3.9529719822483063`*^9}, {
   3.9529720669590626`*^9, 3.952972069436861*^9}, {3.9529722951925564`*^9, 
   3.9529722958274345`*^9}, {3.9529723325387554`*^9, 
   3.9529723604964447`*^9}, {3.9529723906642113`*^9, 3.952972392411274*^9}, {
   3.9529724794695587`*^9, 3.952972481121214*^9}, {3.952972585293232*^9, 
   3.952972589613119*^9}, {3.9529729326580887`*^9, 3.952973110147051*^9}, {
   3.9529731790746574`*^9, 3.952973182458391*^9}, {3.952973261804085*^9, 
   3.9529732810412846`*^9}, {3.952973315112686*^9, 3.9529734781962852`*^9}, {
   3.952973534730915*^9, 3.952973534894182*^9}, {3.9529736921728745`*^9, 
   3.9529736981674614`*^9}, {3.952973737179657*^9, 3.952973839447384*^9}, {
   3.952974089696335*^9, 3.9529741701501236`*^9}, {3.9529742610660667`*^9, 
   3.9529743388450184`*^9}, {3.9529745643269787`*^9, 
   3.9529745803871326`*^9}, {3.9529746385924225`*^9, 
   3.9529746752502174`*^9}, {3.9529747711924057`*^9, 3.952974804899679*^9}, {
   3.952974842445837*^9, 3.9529749660538425`*^9}, {3.952974998648741*^9, 
   3.9529751410538425`*^9}, {3.9529752783632736`*^9, 3.952975287956753*^9}, 
   3.9529755076237392`*^9, {3.9529756986150475`*^9, 3.952975706827942*^9}, {
   3.9529757679679832`*^9, 3.9529757847435055`*^9}, {3.9529759482212296`*^9, 
   3.952975955037302*^9}},ExpressionUUID->"2300556e-aecc-da4f-a92b-\
bee4d6fffcab"],

Cell[BoxData[{"\"\<128042225085\>\"", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DecodeRSA", "[", 
   RowBox[{
    RowBox[{"code_", "?", "StringQ"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n_", "?", "NumberQ"}], ",", 
      RowBox[{"d_", "?", "NumberQ"}]}], "}"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"FromCharacterCode", "@", 
   RowBox[{"PowerMod", "[", 
    RowBox[{
     RowBox[{"ToExpression", "@", 
      RowBox[{"StringPartition", "[", 
       RowBox[{"code", ",", 
        RowBox[{"IntegerLength", "@", "n"}]}], "]"}]}], ",", "d", ",", "n"}], 
    "]"}]}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9529752928022385`*^9, 3.9529754257459297`*^9}, {
  3.95297560172711*^9, 3.952975605428274*^9}, {3.9529758297167683`*^9, 
  3.9529758369008045`*^9}},ExpressionUUID->"8b55d9c4-84cb-8d47-81d6-\
7bcdd1c90a9e"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9529758407877464`*^9, 
  3.952975841810646*^9}},ExpressionUUID->"c44a4b13-1017-b247-8b74-\
4bafa266e4ae"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9529755028835163`*^9, 3.9529755028858166`*^9}},
 CellLabel->
  "In[1080]:=",ExpressionUUID->"12aaef93-cca4-e34c-94fd-38d91e9464b3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"EncodeRSA", "[", 
    RowBox[{
    "\"\<\:0437\:0430\:0448\:0438\:0444\:0440\:0443\:0435\:043c \:0444\:0440\
\:0430\:0437\:0443\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"130609", ",", "64937"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.952975510933693*^9, 3.952975523116928*^9}, {
  3.952975846029274*^9, 3.9529758800437717`*^9}},
 CellLabel->
  "In[1095]:=",ExpressionUUID->"a463c3ff-2cd2-c24d-a060-ac602099e65c"],

Cell[BoxData["\<\"\
526245899623821372493975224960360680557159807352263975224960589965262436068\"\
\>"], "Output",
 CellChangeTimes->{
  3.9529755240173626`*^9, 3.9529757195217094`*^9, {3.9529758831344414`*^9, 
   3.952975907218666*^9}},
 CellLabel->
  "Out[1095]=",ExpressionUUID->"0f08ac6d-7bf6-2342-a005-a6dc377c83d1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DecodeRSA", "[", 
  RowBox[{
  "\"\<52624589962382137249397522496036068055715980735226397522496058996526243\
6068\>\"", ",", 
   RowBox[{"{", 
    RowBox[{"130609", ",", "64937"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9529755260724945`*^9, 3.9529755636385193`*^9}, {
  3.9529757257133255`*^9, 3.952975731038458*^9}, {3.9529759859717216`*^9, 
  3.9529760057391376`*^9}},
 CellLabel->
  "In[1096]:=",ExpressionUUID->"cfce50e9-9667-d94c-89ed-a324f7ae0ed6"],

Cell[BoxData["\<\"\:80ab\:63f2\[Yen]\:0fed\[UDoubleAcute]\:0d4d\:6af7\:a8c7\
\:2903\:68db\[UDoubleAcute]\:0d4d\:63f2\:80ab\:6af7\"\>"], "Output",
 CellChangeTimes->{3.952975611921009*^9, 3.952975733001356*^9, 
  3.9529760069338665`*^9},
 CellLabel->
  "Out[1096]=",ExpressionUUID->"f49ab65d-e386-3149-8399-e45c7ca9acf9"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9529755683518753`*^9, 
  3.952975568355652*^9}},ExpressionUUID->"dd58c7ea-e5b5-9d40-bd48-\
298037345721"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.952975433832882*^9, 3.952975455353306*^9}, {
  3.952975501662754*^9, 
  3.952975501967905*^9}},ExpressionUUID->"b06c1ec0-074d-a94d-a44c-\
96ca281054e5"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.952975503905756*^9, 
  3.9529755039098854`*^9}},ExpressionUUID->"2d796e62-3907-184c-9e6d-\
3cb922c7a7c4"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9529753050830116`*^9, 
  3.9529753050854225`*^9}},ExpressionUUID->"b5051149-1ca0-bf46-8da3-\
a4f0d4c7074b"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.9529752941647854`*^9, 
  3.9529753041060066`*^9}},ExpressionUUID->"dad4669b-345a-7742-bc76-\
b3aed0e3c5a8"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.952975247094839*^9},ExpressionUUID->"91167744-3ea1-be4a-8119-\
1db634387703"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9529750900671253`*^9, 
  3.952975099837263*^9}},ExpressionUUID->"5db78d21-603e-2b48-82f9-\
80dc0c03fee3"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9529750967270126`*^9, 
  3.9529750967290745`*^9}},ExpressionUUID->"a6bb4ea6-e545-7a48-b78a-\
57f34e9cf1db"],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.952975008960516*^9, 
  3.9529750939844666`*^9},ExpressionUUID->"df5c02e0-0c88-4f43-941c-\
de3c2fc67b7e"],

Cell[BoxData[
 TemplateBox[{
  "StringJoin", "string", 
   "\"String expected at position \\!\\(\\*RowBox[{\\\"2\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"\\\\\\\"{128, 42, 225, 85}\\\\\\\"\\\", \\\"<>\\\", \
\\\"3\\\", \\\"<>\\\", \\\"\\\\\\\"0\\\\\\\"\\\"}]\\).\"", 2, 1035, 262, 
   34856021487428504194, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9529750089695168`*^9},
 CellLabel->
  "During evaluation of \
In[1035]:=",ExpressionUUID->"8a71f5c0-5725-9c44-83fa-be99622fbc9a"],

Cell[BoxData[
 TemplateBox[{
  "StringPadLeft", "strlist", 
   "\"List of strings expected at position \\!\\(\\*RowBox[{\\\"1\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"StringPadLeft\\\", \\\"[\\\", RowBox[{\\\"\\\\\\\"{128, \
42, 225, 85}\\\\\\\"\\\", \\\"<>\\\", \\\"3\\\", \\\"<>\\\", \
\\\"\\\\\\\"0\\\\\\\"\\\"}], \\\"]\\\"}]\\).\"", 2, 1035, 263, 
   34856021487428504194, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9529750089755135`*^9},
 CellLabel->
  "During evaluation of \
In[1035]:=",ExpressionUUID->"61a2d56b-7c2d-7a43-912e-618bebba8fb0"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9529750953945446`*^9, 
  3.9529750953966007`*^9}},ExpressionUUID->"6fe592d2-620f-d140-9e9d-\
d163d5da6d56"]
},
WindowSize->{497.4, 544.8},
WindowMargins->{{Automatic, -10.799999999999955`}, {Automatic, 6.6}},
FrontEndVersion->"14.1 for Microsoft Windows (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"c2c9055e-18df-374f-b50e-eb3d1ba63dcc"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 4746, 106, 609, "Input",ExpressionUUID->"2300556e-aecc-da4f-a92b-bee4d6fffcab"],
Cell[5303, 128, 860, 21, 188, "Input",ExpressionUUID->"8b55d9c4-84cb-8d47-81d6-7bcdd1c90a9e"],
Cell[6166, 151, 154, 3, 28, "Input",ExpressionUUID->"c44a4b13-1017-b247-8b74-4bafa266e4ae"],
Cell[6323, 156, 180, 3, 28, "Input",ExpressionUUID->"12aaef93-cca4-e34c-94fd-38d91e9464b3"],
Cell[CellGroupData[{
Cell[6528, 163, 526, 13, 66, "Input",ExpressionUUID->"a463c3ff-2cd2-c24d-a060-ac602099e65c"],
Cell[7057, 178, 321, 7, 65, "Output",ExpressionUUID->"0f08ac6d-7bf6-2342-a005-a6dc377c83d1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7415, 190, 488, 11, 66, "Input",ExpressionUUID->"cfce50e9-9667-d94c-89ed-a324f7ae0ed6"],
Cell[7906, 203, 320, 5, 66, "Output",ExpressionUUID->"f49ab65d-e386-3149-8399-e45c7ca9acf9"]
}, Open  ]],
Cell[8241, 211, 154, 3, 28, "Input",ExpressionUUID->"dd58c7ea-e5b5-9d40-bd48-298037345721"],
Cell[8398, 216, 201, 4, 28, "Input",ExpressionUUID->"b06c1ec0-074d-a94d-a44c-96ca281054e5"],
Cell[8602, 222, 154, 3, 28, "Input",ExpressionUUID->"2d796e62-3907-184c-9e6d-3cb922c7a7c4"],
Cell[8759, 227, 156, 3, 28, "Input",ExpressionUUID->"b5051149-1ca0-bf46-8da3-a4f0d4c7074b"],
Cell[8918, 232, 175, 3, 47, "Input",ExpressionUUID->"dad4669b-345a-7742-bc76-b3aed0e3c5a8"],
Cell[9096, 237, 147, 3, 47, "Input",ExpressionUUID->"91167744-3ea1-be4a-8119-1db634387703"],
Cell[9246, 242, 154, 3, 28, "Input",ExpressionUUID->"5db78d21-603e-2b48-82f9-80dc0c03fee3"],
Cell[9403, 247, 156, 3, 28, "Input",ExpressionUUID->"a6bb4ea6-e545-7a48-b78a-57f34e9cf1db"],
Cell[CellGroupData[{
Cell[9584, 254, 152, 3, 28, "Input",ExpressionUUID->"df5c02e0-0c88-4f43-941c-de3c2fc67b7e"],
Cell[9739, 259, 502, 11, 26, "Message",ExpressionUUID->"8a71f5c0-5725-9c44-83fa-be99622fbc9a"],
Cell[10244, 272, 572, 12, 44, "Message",ExpressionUUID->"61a2d56b-7c2d-7a43-912e-618bebba8fb0"]
}, Open  ]],
Cell[10831, 287, 156, 3, 28, "Input",ExpressionUUID->"6fe592d2-620f-d140-9e9d-d163d5da6d56"]
}
]
*)

(* End of internal cache information *)

